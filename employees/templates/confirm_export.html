{% extends "base.html" %}
{% block title %}–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —ç–∫—Å–ø–æ—Ä—Ç–∞{% endblock %}

{% block content %}
<div class="max-w-xl mx-auto bg-white shadow-md rounded-lg p-6">
    {% if count > 0 %}
        <h2 class="text-xl font-bold text-gray-800 mb-4">
            –ù–∞–π–¥–µ–Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞: {{ count }}
        </h2>
        <form method="get" action="{% url 'export_excel' %}" class="flex space-x-3">
            <!-- –°–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
            {% for key, value in request.GET.items %}
                <input type="hidden" name="{{ key }}" value="{{ value }}">
            {% endfor %}
            <button type="submit"
                    class="bg-green-600 text-white px-4 py-2 rounded-md shadow hover:bg-green-700 transition">
                –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel
            </button>
            <a href="{{ prev_url }}"
               class="bg-gray-300 text-gray-800 px-4 py-2 rounded-md shadow hover:bg-gray-400 transition">
                –û—Ç–º–µ–Ω–∞
            </a>
        </form>
    {% else %}
        <h2 class="text-xl font-semibold text-gray-700 mb-4">
            –ù–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞.
        </h2>
        <a href="{{ prev_url }}"
           class="bg-gray-300 text-gray-800 px-4 py-2 rounded-md shadow hover:bg-gray-400 transition">
            –ù–∞–∑–∞–¥
        </a>
    {% endif %}
</div>

<script>
    // üìå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ —ç–∫—Å–ø–æ—Ä—Ç–∞
    document.querySelector("form")?.addEventListener("submit", function() {
        setTimeout(function() {
            window.location.href = "{{ prev_url }}";
        }, 1500);
    });
</script>
{% endblock %}
